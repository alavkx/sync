# Kalphite Architecture Glossary

A dictionary of the key terms and concepts used in the Kalphite architectural design.

| Term                        | Definition                                                                                                                                          | Role in Our Design                                                                                                                                                      |
| :-------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Event Sourcing**          | An architectural pattern where all changes to application state are stored as a sequence of immutable events. The "ledger" approach.                | The core of our write model. The `mutations` table is our event log and serves as the ultimate source of truth.                                                         |
| **Mutation / Event**        | An immutable record of something that happened in the past (e.g., `CommentAdded`, `ReviewApproved`).                                                | The fundamental unit of data in our event log.                                                                                                                          |
| **CQRS**                    | **Command Query Responsibility Segregation.** An architectural pattern that separates the models for reading data from the models for writing data. | The high-level pattern that allows us to use Event Sourcing for writes and a traditional database for reads, getting the best of both worlds.                           |
| **Command**                 | An instruction to do something in the system. The intent to change state.                                                                           | A user action that results in a `mutation` being sent to the server to be validated and added to the event log.                                                         |
| **Query**                   | A request to read data from the system, which does not change any state.                                                                            | A request from the client to the server's Read Model to get data for the UI.                                                                                            |
| **Read Model**              | An optimized, often denormalized, database designed specifically for the read/query patterns of an application.                                     | The traditional, relational database (`comments`, `users` tables) on our server that is built from the event log and used to answer client queries quickly.             |
| **Projection**              | The process of transforming a stream of events into a Read Model. Also refers to the resulting Read Model itself.                                   | The server-side process (the "Projector") that listens for new events and updates the Read Model tables.                                                                |
| **Client State Projection** | A specific, often hierarchical, subset of the Read Model that is shaped for the needs of a particular UI view.                                      | The Zod schema (`reviewProjectionSchema`) defines this. It's the type-safe JavaScript object the client component actually works with.                                  |
| **Translator**              | A component responsible for converting data from one model to another.                                                                              | Our API layer (e.g., GraphQL or tRPC resolvers) acts as the translator, converting data from the relational **Read Model** into the nested **Client State Projection**. |
| **Shared Schema**           | A data-shape definition (using a tool like Zod) that is shared and used by both the client and the server.                                          | The ultimate contract that guarantees type safety across our entire system. It ensures the Translator's output is always correct.                                       |
| **Subscription**            | A long-lived connection that allows the server to push data to the client when changes occur.                                                       | The mechanism (e.g., WebSockets via GraphQL or tRPC) used to keep the client's projection in real-time sync with the server's Read Model.                               |
| **Optimistic Update**       | The practice of updating the client's UI immediately after a user action, before receiving confirmation from the server.                            | A key feature of our client. When a user creates a comment, we optimistically update the UI by running a client-side projector on the new `pending` event.              |
| **Hydration**               | The process of populating the client with its initial state when it first loads.                                                                    | The client calls a specific API endpoint (`getReviewHydrationSlice`) to get a large, pre-computed projection of the Read Model to start with.                           |
